
# 1.背景

秒杀系统的流量监控图，是一条直线，就在秒杀开始那一秒是一条很直很直的线，请求在时间上高度集中于某一特定的时间点。这样就会导致一个特别高的流量峰值，它对资源的消耗是瞬时的。

但是对秒杀这个场景来说，最终能够抢到商品的人数是固定的，也就是说 100 人和 10000 人发起请求的结果都是一样的，并发度越高，无效请求也越多。

但是从业务上来说，秒杀活动是希望更多的人来参与的，也就是开始之前希望有更多的人来刷页面，但是真正开始下单时，秒杀请求并不是越多越好。

因此我们可以设计一些规则，让并发的请求更多地延缓，而且我们甚至可以过滤掉一些无效请求。

# 2.削峰

流量出现峰值的话，容易导致请求处理不过来，闲的时候却又没有什么要处理。但是服务器的处理资源是恒定的，由于要保证服务质量，处理资源只能按照忙的时候来预估，而这会导致资源的一个浪费。

## 2.1 削峰的好处

（1）可以让服务端处理变得更加平稳。

（2）可以节省服务器的资源成本。

针对秒杀这一场景，削峰从本质上来说就是更多地延缓用户请求的发出，以便减少和过滤掉一些无效请求，它遵从“请求数要尽量少”的原则。

## 2.2 常见的削峰手段

排队、答题、分层过滤。这几种方式都是无损（即不会损失用户的发出请求）的实现方案，当然还有些有损的实现方案，包括我们后面要介绍的关于稳定性的一些办法，比如限流和机器负载保护等一些强制措施也能达到削峰保护的目的，当然这都是不得已的一些措施，因此就不归类到这里了。

